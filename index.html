<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Laundry-Room Gantt ‚Äì Kid-Friendly & Editable</title>
<link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600&display=swap" rel="stylesheet" />
<style>
  html,body{height:100%;margin:0;background:#f5f7fa;font-family:Arial,Helvetica,sans-serif}
  h1{margin:10px 6px;text-align:center;font-family:'Fredoka',sans-serif;font-weight:600;color:#333}
  #chart{width:100%;height:70vh}
  #hint{text-align:center;font-family:'Fredoka',sans-serif;font-size:1rem;margin-top:4px;color:#555}
  #taskForm{display:flex;flex-wrap:wrap;gap:6px;justify-content:center;margin:6px;font-family:'Fredoka',sans-serif}
  #taskForm input, #taskForm button{padding:6px 8px;border:1px solid #ccc;border-radius:4px;font-size:0.9rem}
  #taskForm input[type="date"]{font-family:inherit}
  #taskForm button{background:#06d6a0;color:#fff;cursor:pointer;border:none;font-weight:600}
  #taskForm button:hover{background:#05b68b}
  @media(max-width:600px){#chart{height:60vh}}
</style>
<script src="https://www.gstatic.com/charts/loader.js"></script>
<script>
  google.charts.load('current',{packages:['timeline']});
  google.charts.setOnLoadCallback(init);

  const palette=[
    '#ff6f61','#6ec5ff','#ffd166','#06d6a0','#e14ecd',
    '#ffb5a7','#4cc9f0','#c77dff','#70d6ff','#ffafcc'
  ];

  const storageKey='laundryRenoTasks_v2';

  const defaultTasks=[
    ['Pre-Renovation','üßπ Purge & Sort','2025-06-01','2025-06-02'],
    ['Pre-Renovation','üìè Measure & Plan','2025-06-02','2025-06-03'],
    ['Pre-Renovation','üõí Order Materials','2025-06-03','2025-06-05'],
    ['Pre-Renovation','üìê Surface Prep & Masking','2025-06-06','2025-06-06'],

    ['Week 1: Light & Colour','üí° Swap Ceiling Lights','2025-06-07','2025-06-07'],
    ['Week 1: Light & Colour','üé® Paint Accent Wall','2025-06-08','2025-06-08'],
    ['Week 1: Light & Colour','üåà Ceiling Paint & Cove LEDs','2025-06-09','2025-06-10'],

    ['Week 2: Floor & Smart','üë¢ Remove Carpet / Prep','2025-06-14','2025-06-14'],
    ['Week 2: Floor & Smart','ü™µ Lay Vinyl Planks','2025-06-15','2025-06-15'],
    ['Week 2: Floor & Smart','üå°Ô∏è Install Humidity Sensor + Fan','2025-06-16','2025-06-16'],

    ['Week 3: Storage Build','üõ† Assemble PLATSA Cabinets','2025-06-21','2025-06-21'],
    ['Week 3: Storage Build','üî® Install Counter & Sink','2025-06-22','2025-06-22'],
    ['Week 3: Storage Build','üì¶ Mount BOAXEL System','2025-06-23','2025-06-23'],
    ['Week 3: Storage Build','üö™ Fit Sliding Curtain Track','2025-06-24','2025-06-24'],

    ['Week 4: Finishing','üé® Spray Paint Visible Pipes','2025-06-28','2025-06-28'],
    ['Week 4: Finishing','üß∫ Install Pulley Drying Rack','2025-06-29','2025-06-29'],
    ['Week 4: Finishing','‚òï Coffee Nook & D√©cor','2025-06-30','2025-06-30'],
    ['Week 4: Finishing','‚úÖ QA + Snag-list Fixes','2025-07-01','2025-07-01'],

    ['Post-Renovation','üîß Smart-Sensor Test & Tuning','2025-07-02','2025-07-02'],
    ['Post-Renovation','üì∏ Photo Docs / Celebrate','2025-07-03','2025-07-03']
  ].map((t,i)=>({phase:t[0],title:t[1],start:t[2],end:t[3],done:false,id:i}));

  let tasks;
  let chart,data,options,container;

  function init(){
    tasks=loadTasks();
    buildChart();
    buildForm();
    window.addEventListener('resize',()=>chart.draw(data,options));
  }

  function loadTasks(){
    const stored=localStorage.getItem(storageKey);
    if(stored){
      try{return JSON.parse(stored);}catch(e){console.error(e)}
    }
    saveTasks(defaultTasks);
    return JSON.parse(JSON.stringify(defaultTasks));
  }

  function saveTasks(t){localStorage.setItem(storageKey,JSON.stringify(t));}

  function buildChart(){
    if(!container) container=document.getElementById('chart');
    if(!chart) chart=new google.visualization.Timeline(container);

    data=new google.visualization.DataTable();
    data.addColumn({type:'string',id:'Phase'});
    data.addColumn({type:'string',id:'Task'});
    data.addColumn({type:'date',id:'Start'});
    data.addColumn({type:'date',id:'End'});
    data.addColumn({type:'string',role:'style'});

    tasks.forEach((t,idx)=>{
      const color= palette[idx%palette.length];
      const style=t.done? 'color:#A0A0A0;stroke-dasharray:5 2':'';
      data.addRow([t.phase,t.title,new Date(t.start),new Date(t.end),style||`color:${color}`]);
    });

    options={
      timeline:{showRowLabels:true,groupByRowLabel:true},
      avoidOverlappingGridLines:true,
      backgroundColor:'#f5f7fa',
      tooltip:{isHtml:true}
    };

    chart.draw(data,options);
    google.visualization.events.removeAllListeners(chart);
    google.visualization.events.addListener(chart,'select',() => {
      const sel=chart.getSelection();
      if(!sel.length) return;
      const row=sel[0].row;
      tasks[row].done=!tasks[row].done;
      saveTasks(tasks);
      buildChart();
    });
  }

  // ---------- ADD NEW TASK UI ----------
  function buildForm(){
    const form=document.createElement('div');
    form.id='taskForm';
    form.innerHTML=`
      <input id="phase" placeholder="Phase (e.g. Week 2: Floor & Smart)" required />
      <input id="title" placeholder="Task description" required />
      <input type="date" id="start" required />
      <input type="date" id="end" required />
      <button id="addBtn">Add Task</button>
    `;
    document.body.insertBefore(form,document.getElementById('chart'));
    document.getElementById('addBtn').addEventListener('click',e=>{
      e.preventDefault();
      const phase=document.getElementById('phase').value.trim();
      const title=document.getElementById('title').value.trim();
      const start=document.getElementById('start').value;
      const end=document.getElementById('end').value;
      if(!(phase&&title&&start&&end)){
        alert('Please fill out all fields');return;
      }
      if(new Date(start)>new Date(end)){
        alert('Start date must be before End date');return;
      }
      tasks.push({phase,title,start,end,done:false,id:Date.now()});
      saveTasks(tasks);
      // Clear fields
      document.getElementById('phase').value='';
      document.getElementById('title').value='';
      document.getElementById('start').value='';
      document.getElementById('end').value='';
      buildChart();
    });
  }
</script>
</head>
<body>
  <h1>Laundry-Room Renovation ‚Äì Summer 2025</h1>
  <p id="hint">Click a bar when you finish a task üèÅ ‚Äì or add a new one below:</p>
  <div id="chart"></div>
</body>
</html>
